{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\momod\\\\T-JSF-600-PAR_2\\\\irc-client\\\\src\\\\Hometalk.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\nimport './Hometalk.css';\nimport ChatComponent from './Chatcomponent';\nimport socket from './socket';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction Hometalk() {\n  _s();\n  const [username, setUsername] = useState('');\n  const [channels, setChannels] = useState([]);\n  const [activeChannel, setActiveChannel] = useState(null);\n  useEffect(() => {\n    const fetchUserInfo = async () => {\n      try {\n        const token = localStorage.getItem('token');\n        const response = await fetch('http://localhost:5000/api/auth/userinfo', {\n          method: 'GET',\n          headers: {\n            'Authorization': `Bearer ${token}`\n          }\n        });\n        const data = await response.json();\n        if (response.status === 200) {\n          setUsername(data.username);\n        }\n      } catch (error) {\n        console.error('Erreur lors de la récupération des informations utilisateur:', error);\n      }\n    };\n    fetchUserInfo();\n  }, []);\n  useEffect(() => {\n    const fetchChannels = async () => {\n      try {\n        const token = localStorage.getItem('token');\n        const response = await fetch('http://localhost:5000/api/channels', {\n          headers: {\n            'Authorization': `Bearer ${token}`\n          }\n        });\n        const data = await response.json();\n        if (response.ok) {\n          setChannels(data);\n          if (!activeChannel && data.length > 0) setActiveChannel(data[0]);\n        }\n      } catch (err) {\n        console.error('Erreur lors du chargement des channels:', err);\n      }\n    };\n    fetchChannels();\n  }, []);\n\n  // Join le channel actif côté socket\n  useEffect(() => {\n    const userId = localStorage.getItem('userId');\n    if (activeChannel && userId) {\n      socket.emit('joinChannel', {\n        userId,\n        channelId: activeChannel._id\n      });\n      return () => {\n        socket.emit('quitChannel', {\n          userId,\n          channelId: activeChannel._id\n        });\n      };\n    }\n  }, [activeChannel]);\n  const handleChannelClick = channel => {\n    setActiveChannel(channel);\n  };\n  const handleLogout = () => {\n    localStorage.removeItem('token');\n    window.location.href = '/log';\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"hometalk-container\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"channel-box\",\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        children: \"Canaux\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 74,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n        children: channels.map(channel => /*#__PURE__*/_jsxDEV(\"li\", {\n          className: `channel-item${activeChannel && activeChannel._id === channel._id ? ' active' : ''}`,\n          onClick: () => handleChannelClick(channel),\n          children: channel.name\n        }, channel._id, false, {\n          fileName: _jsxFileName,\n          lineNumber: 77,\n          columnNumber: 13\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 75,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 73,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"profile-card\",\n      children: /*#__PURE__*/_jsxDEV(\"h2\", {\n        className: \"username\",\n        children: username\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 84,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      className: \"logout-button\",\n      onClick: handleLogout,\n      children: \"Se d\\xE9connecter\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"content\",\n      children: activeChannel && /*#__PURE__*/_jsxDEV(ChatComponent, {\n        username: username,\n        channel: activeChannel,\n        channels: channels,\n        setChannels: setChannels\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 90,\n        columnNumber: 27\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 72,\n    columnNumber: 5\n  }, this);\n}\n_s(Hometalk, \"0zJguPvWZC4ShanPI/IHD1B0QfM=\");\n_c = Hometalk;\nexport default Hometalk;\nvar _c;\n$RefreshReg$(_c, \"Hometalk\");","map":{"version":3,"names":["React","useState","useEffect","ChatComponent","socket","jsxDEV","_jsxDEV","Hometalk","_s","username","setUsername","channels","setChannels","activeChannel","setActiveChannel","fetchUserInfo","token","localStorage","getItem","response","fetch","method","headers","data","json","status","error","console","fetchChannels","ok","length","err","userId","emit","channelId","_id","handleChannelClick","channel","handleLogout","removeItem","window","location","href","className","children","fileName","_jsxFileName","lineNumber","columnNumber","map","onClick","name","_c","$RefreshReg$"],"sources":["C:/Users/momod/T-JSF-600-PAR_2/irc-client/src/Hometalk.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport './Hometalk.css';\r\nimport ChatComponent from './Chatcomponent';\r\nimport socket from './socket';\r\n\r\nfunction Hometalk() {\r\n  const [username, setUsername] = useState('');\r\n  const [channels, setChannels] = useState([]);\r\n  const [activeChannel, setActiveChannel] = useState(null);\r\n\r\n  useEffect(() => {\r\n    const fetchUserInfo = async () => {\r\n      try {\r\n        const token = localStorage.getItem('token');\r\n        const response = await fetch('http://localhost:5000/api/auth/userinfo', {\r\n          method: 'GET',\r\n          headers: {\r\n            'Authorization': `Bearer ${token}`,\r\n          },\r\n        });\r\n        const data = await response.json();\r\n        if (response.status === 200) {\r\n          setUsername(data.username);\r\n        }\r\n      } catch (error) {\r\n        console.error('Erreur lors de la récupération des informations utilisateur:', error);\r\n      }\r\n    };\r\n    fetchUserInfo();\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    const fetchChannels = async () => {\r\n      try {\r\n        const token = localStorage.getItem('token');\r\n        const response = await fetch('http://localhost:5000/api/channels', {\r\n          headers: { 'Authorization': `Bearer ${token}` },\r\n        });\r\n        const data = await response.json();\r\n        if (response.ok) {\r\n          setChannels(data);\r\n          if (!activeChannel && data.length > 0) setActiveChannel(data[0]);\r\n        }\r\n      } catch (err) {\r\n        console.error('Erreur lors du chargement des channels:', err);\r\n      }\r\n    };\r\n    fetchChannels();\r\n  }, []);\r\n\r\n  // Join le channel actif côté socket\r\n  useEffect(() => {\r\n    const userId = localStorage.getItem('userId');\r\n    if (activeChannel && userId) {\r\n      socket.emit('joinChannel', { userId, channelId: activeChannel._id });\r\n      return () => {\r\n        socket.emit('quitChannel', { userId, channelId: activeChannel._id });\r\n      };\r\n    }\r\n  }, [activeChannel]);\r\n\r\n  const handleChannelClick = (channel) => {\r\n    setActiveChannel(channel);\r\n  };\r\n\r\n  const handleLogout = () => {\r\n    localStorage.removeItem('token');\r\n    window.location.href = '/log';\r\n  };\r\n\r\n  return (\r\n    <div className=\"hometalk-container\">\r\n      <div className=\"channel-box\">\r\n        <h3>Canaux</h3>\r\n        <ul>\r\n          {channels.map(channel => (\r\n            <li key={channel._id} className={`channel-item${activeChannel && activeChannel._id === channel._id ? ' active' : ''}`} onClick={() => handleChannelClick(channel)}>\r\n              {channel.name}\r\n            </li>\r\n          ))}\r\n        </ul>\r\n      </div>\r\n      <div className=\"profile-card\">\r\n        <h2 className=\"username\">{username}</h2>\r\n      </div>\r\n      <button className=\"logout-button\" onClick={handleLogout}>\r\n        Se déconnecter\r\n      </button>\r\n      <div className=\"content\">\r\n        {activeChannel && <ChatComponent username={username} channel={activeChannel} channels={channels} setChannels={setChannels} />}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Hometalk;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}